# Testing Guide - 测试指南

彩虹桥纪念网站测试指南

## 测试环境

### 本地测试

```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 访问 http://localhost:3000
```

---

## 1. 功能测试

### 1.1 用户认证系统

**注册流程测试：**
- [ ] 访问 `/register`
- [ ] 填写姓名、邮箱、密码
- [ ] 提交表单
- [ ] 验证收到邮件确认链接
- [ ] 点击邮件中的确认链接
- [ ] 确认跳转到 Dashboard

**登录流程测试：**
- [ ] 访问 `/login`
- [ ] 使用正确的邮箱和密码登录
- [ ] 确认跳转到 Dashboard
- [ ] 测试"记住我"功能
- [ ] 测试错误密码提示

**Google OAuth 测试：**
- [ ] 点击"使用 Google 登录"
- [ ] 完成 Google 授权流程
- [ ] 确认自动创建账户并登录

**密码重置测试：**
- [ ] 访问 `/forgot-password`
- [ ] 输入注册邮箱
- [ ] 验证收到重置密码邮件
- [ ] 点击邮件中的重置链接
- [ ] 设置新密码
- [ ] 使用新密码登录

**登出测试：**
- [ ] 点击用户菜单中的"退出登录"
- [ ] 确认跳转到登录页
- [ ] 尝试访问受保护页面，确认重定向到登录页

---

### 1.2 纪念页创建流程

**步骤 1 - 基本信息：**
- [ ] 访问 `/memorials/create`
- [ ] 输入宠物名字（必填）
- [ ] 选择宠物种类（必填）
- [ ] 输入品种（可选）
- [ ] 选择出生日期（可选）
- [ ] 选择离世日期（可选）
- [ ] 选择隐私设置
- [ ] 点击"下一步"
- [ ] 验证必填字段校验

**步骤 2 - 照片上传：**
- [ ] 点击或拖拽上传照片
- [ ] 上传多张照片
- [ ] 查看照片预览
- [ ] 删除照片
- [ ] 验证文件类型限制（只允许图片）
- [ ] 验证文件大小限制（5MB）
- [ ] 至少上传 1 张照片后点击"下一步"

**步骤 3 - 生平故事：**
- [ ] 输入生平故事（可选）
- [ ] 输入纪念文（可选）
- [ ] 使用写作模板
- [ ] 点击"创建纪念页"
- [ ] 确认跳转到纪念页详情

**创建后验证：**
- [ ] 纪念页显示正确信息
- [ ] 照片正确显示
- [ ] 生平故事和纪念文正确显示
- [ ] 隐私设置生效
- [ ] 纪念页出现在 Dashboard 列表中

---

### 1.3 纪念页展示

**访问测试：**
- [ ] 访问公开纪念页（不需登录）
- [ ] 访问不公开索引纪念页（通过链接）
- [ ] 尝试访问私密纪念页（非所有者）
- [ ] 确认私密页面重定向

**内容展示：**
- [ ] Hero 区域显示宠物信息
- [ ] 照片画廊正常显示
- [ ] 点击照片进入 Lightbox
- [ ] Lightbox 中可以浏览所有照片
- [ ] 生平故事区域显示
- [ ] 纪念文区域显示
- [ ] 访问计数正确增加

**响应式测试：**
- [ ] 移动端布局正常
- [ ] 平板端布局正常
- [ ] 桌面端布局正常

---

### 1.4 虚拟悼念功能

**蜡烛测试：**
- [ ] 切换到"点亮蜡烛"标签
- [ ] 点击蜡烛图标
- [ ] 查看点亮动画
- [ ] 确认蜡烛计数增加
- [ ] 确认 Toast 通知显示
- [ ] 刷新页面，验证状态保持

**鲜花测试：**
- [ ] 切换到"献上鲜花"标签
- [ ] 点击四种花类型（玫瑰、百合、菊花、郁金香）
- [ ] 查看献花动画
- [ ] 确认鲜花计数增加
- [ ] 确认 Toast 通知显示
- [ ] 验证花语正确显示

**匿名访客测试：**
- [ ] 登出账户
- [ ] 访问纪念页
- [ ] 点亮蜡烛（匿名）
- [ ] 献上鲜花（匿名）
- [ ] 确认功能正常

---

### 1.5 留言板功能

**留言提交（已登录）：**
- [ ] 滚动到留言板区域
- [ ] 输入留言内容（最多 500 字）
- [ ] 点击"提交留言"
- [ ] 确认 Toast 通知"留言提交成功"
- [ ] 确认提示"正在审核中"

**留言提交（匿名）：**
- [ ] 登出账户
- [ ] 访问纪念页
- [ ] 输入留言内容
- [ ] 输入姓名（必填）
- [ ] 输入邮箱（可选）
- [ ] 提交留言
- [ ] 确认成功提示

**留言显示：**
- [ ] 只显示已批准的留言
- [ ] 留言按时间倒序排列
- [ ] 显示作者姓名
- [ ] 显示相对时间（"3 小时前"）
- [ ] 匿名留言显示"匿名访客"

**字符限制：**
- [ ] 输入超过 500 字
- [ ] 确认提交失败
- [ ] 查看字符计数

---

### 1.6 Dashboard 功能

**纪念页列表：**
- [ ] 访问 `/dashboard`
- [ ] 查看所有纪念页卡片
- [ ] 卡片显示宠物名字、品种、日期
- [ ] 卡片显示隐私状态
- [ ] 点击卡片跳转到纪念页
- [ ] 空状态显示正确

**创建按钮：**
- [ ] 点击"创建纪念页"按钮
- [ ] 确认跳转到创建页面

**导航功能：**
- [ ] 点击顶部导航链接
- [ ] "我的纪念页"高亮
- [ ] "创建纪念页"跳转正确
- [ ] "账户设置"跳转正确

---

### 1.7 账户设置

**个人资料：**
- [ ] 访问 `/settings`
- [ ] 修改姓名
- [ ] 点击"保存更改"
- [ ] 确认成功提示
- [ ] 刷新页面验证更改

**密码修改：**
- [ ] 切换到"安全"标签
- [ ] 输入新密码
- [ ] 确认新密码
- [ ] 点击"更新密码"
- [ ] 确认成功提示
- [ ] 登出后使用新密码登录

**密码验证：**
- [ ] 测试密码不匹配提示
- [ ] 测试密码太短提示（< 6 字符）

---

### 1.8 首页功能

**Hero 区域：**
- [ ] 访问 `/`
- [ ] 查看 Hero 标题和描述
- [ ] 点击"创建纪念页"按钮
- [ ] 点击"浏览纪念墙"按钮
- [ ] 查看统计数据

**彩虹桥故事墙：**
- [ ] 查看公开纪念页卡片
- [ ] 瀑布流布局正确
- [ ] 点击"最新创建"排序
- [ ] 点击"最多访问"排序
- [ ] 验证排序功能正常
- [ ] 点击卡片跳转到纪念页

**CTA 区域：**
- [ ] 查看功能介绍
- [ ] 点击"免费创建纪念页"按钮
- [ ] 验证跳转正确

---

### 1.9 管理员功能

**留言审核：**
- [ ] 访问 `/admin/tributes`
- [ ] 查看待审核留言列表
- [ ] 点击"批准"按钮
- [ ] 确认留言从列表中移除
- [ ] 访问纪念页，确认留言显示
- [ ] 点击"拒绝"按钮
- [ ] 确认留言被删除

**统计信息：**
- [ ] 查看待审核数量
- [ ] 查看已批准数量
- [ ] 查看审核率

---

## 2. 性能测试

### 2.1 Lighthouse 审计

运行 Lighthouse 审计（Chrome DevTools）：

```bash
npm run build
npm run start
```

**目标分数：**
- Performance: > 90
- Accessibility: > 95
- Best Practices: > 95
- SEO: > 95

### 2.2 Core Web Vitals

**LCP (Largest Contentful Paint):** < 2.5s
- [ ] 首页 LCP
- [ ] 纪念页 LCP
- [ ] Dashboard LCP

**FID (First Input Delay):** < 100ms
- [ ] 测试按钮点击响应
- [ ] 测试表单输入响应

**CLS (Cumulative Layout Shift):** < 0.1
- [ ] 检查图片加载时的布局偏移
- [ ] 检查字体加载时的布局偏移

### 2.3 加载时间

- [ ] 首页加载时间 < 2s
- [ ] 纪念页加载时间 < 2s
- [ ] Dashboard 加载时间 < 2s
- [ ] 创建页加载时间 < 2s

---

## 3. SEO 测试

### 3.1 Meta 标签

- [ ] 查看页面源代码
- [ ] 验证 title 标签
- [ ] 验证 description 标签
- [ ] 验证 keywords 标签
- [ ] 验证 Open Graph 标签
- [ ] 验证 Twitter Card 标签

### 3.2 Sitemap

- [ ] 访问 `/sitemap.xml`
- [ ] 验证包含首页
- [ ] 验证包含所有公开纪念页
- [ ] 验证 URL 格式正确

### 3.3 Robots.txt

- [ ] 访问 `/robots.txt`
- [ ] 验证允许抓取规则
- [ ] 验证禁止抓取规则
- [ ] 验证 sitemap 链接

---

## 4. 安全测试

### 4.1 认证授权

- [ ] 未登录访问 Dashboard，确认重定向
- [ ] 未登录访问 Settings，确认重定向
- [ ] 未登录访问创建页面，确认重定向
- [ ] 尝试访问他人的私密纪念页，确认拒绝

### 4.2 输入验证

- [ ] 测试 SQL 注入（输入 SQL 代码）
- [ ] 测试 XSS（输入 `<script>` 标签）
- [ ] 测试超长输入
- [ ] 测试特殊字符

### 4.3 文件上传

- [ ] 尝试上传非图片文件
- [ ] 尝试上传超大文件
- [ ] 尝试上传恶意文件

---

## 5. 浏览器兼容性

### 5.1 Chrome
- [ ] 所有功能正常
- [ ] 布局正常
- [ ] 动画流畅

### 5.2 Firefox
- [ ] 所有功能正常
- [ ] 布局正常
- [ ] 动画流畅

### 5.3 Safari
- [ ] 所有功能正常
- [ ] 布局正常
- [ ] 动画流畅

### 5.4 Edge
- [ ] 所有功能正常
- [ ] 布局正常
- [ ] 动画流畅

---

## 6. 移动端测试

### 6.1 响应式布局

测试设备尺寸：
- iPhone SE (375px)
- iPhone 12 Pro (390px)
- iPad (768px)
- iPad Pro (1024px)

### 6.2 触摸交互

- [ ] 按钮可点击
- [ ] 滚动流畅
- [ ] 下拉菜单正常
- [ ] 图片 Lightbox 正常
- [ ] 表单输入正常

---

## 7. 错误处理

### 7.1 网络错误

- [ ] 断网状态下操作
- [ ] 慢速网络下加载
- [ ] 上传失败处理

### 7.2 数据错误

- [ ] 访问不存在的纪念页
- [ ] 数据库查询失败
- [ ] API 调用失败

### 7.3 用户体验

- [ ] 错误提示友好
- [ ] Loading 状态显示
- [ ] Toast 通知及时

---

## 8. 回归测试

每次更新后重新测试：
- [ ] 核心功能（认证、创建、展示）
- [ ] 关键用户流程
- [ ] 最近修改的功能

---

## 测试报告

### 发现的问题

| 编号 | 问题描述 | 严重程度 | 状态 | 备注 |
|------|----------|----------|------|------|
| 1    |          |          |      |      |

### 测试总结

- 测试通过率：___%
- 发现问题数：___
- 已修复问题：___
- 待修复问题：___

---

## 自动化测试（未来）

建议添加：
- E2E 测试（Playwright/Cypress）
- 单元测试（Jest/Vitest）
- API 测试
- 视觉回归测试
